
SELECT DISTINCT  D.FISCAL_QUARTER,SUM(S.VOLUME) AS SALE_VOLUME, S.STORE_ID, ST.STORE_ADDRESS, PY.PAYMENT_DESC, A.AGE_GROUP
FROM DBW.SALES_FACT S 
JOIN DBW.DATE_DIM D 
ON( D.DATEID = S.DATE_ID )
JOIN DBW.STORE_DIM ST 
ON(S.STORE_ID = ST.STORE_ID)
JOIN DBW.PAYMENT_DIM PY 
ON(PY.PAYMENT_TYPE_KEY = S.PAYMENT_KEY)
JOIN DBW.AGE_DIM A 
ON(A.AGEID = S.AGE_ID)
GROUP BY FISCAL_QUARTER, S.STORE_ID, STORE_ADDRESS, PAYMENT_DESC, AGE_GROUP ;

 


SELECT DISTINCT SUM(S.REVENUE) AS SALE_REVENUE, S.STORE_ID, ST.STORE_ADDRESS, PY.PAYMENT_DESC, A.AGE_GROUP, D.FISCAL_QUARTER
FROM DBW.SALES_FACT S
JOIN DBW.DATE_DIM D 
ON( D.DATEID = S.DATE_ID )
JOIN DBW.STORE_DIM ST 
ON(S.STORE_ID = ST.STORE_ID)
JOIN DBW.PAYMENT_DIM PY 
ON(PY.PAYMENT_TYPE_KEY = S.PAYMENT_KEY)
JOIN DBW.AGE_DIM A 
ON(A.AGEID = S.AGE_ID)
GROUP BY FISCAL_QUARTER, S.STORE_ID, STORE_ADDRESS, PAYMENT_DESC, AGE_GROUP;
 

SELECT DISTINCT D.FISCAL_QUARTER,SUM(S.PROFIT) AS SALE_PROFIT, S.STORE_ID, ST.STORE_ADDRESS, PY.PAYMENT_DESC, A.AGE_GROUP
FROM DBW.SALES_FACT S
JOIN DBW.DATE_DIM D
ON( D.DATEID = S.DATE_ID )
JOIN DBW.STORE_DIM ST 
ON(S.STORE_ID = ST.STORE_ID)
JOIN DBW.PAYMENT_DIM PY
ON(PY.PAYMENT_TYPE_KEY = S.PAYMENT_KEY)
JOIN DBW.AGE_DIM A
ON(A.AGEID = S.AGE_ID)
GROUP BY FISCAL_QUARTER,S.STORE_ID, STORE_ADDRESS, PAYMENT_DESC, AGE_GROUP
 

  
SELECT DISTINCT D.FISCAL_QUARTER, SUM(S.PROFIT) AS SALE_PROFIT, S.STORE_ID, ST.STORE_ADDRESS, PY.PAYMENT_DESC, A.AGE_GROUP
FROM DBW.SALES_FACT S
JOIN DBW.DATE_DIM D ON(D.DATEID = S.DATE_ID)
JOIN DBW.STORE_DIM ST ON(S.STORE_ID = ST.STORE_ID)
JOIN DBW.PAYMENT_DIM PY ON(PY.PAYMENT_TYPE_KEY = S.PAYMENT_KEY)
JOIN DBW.AGE_DIM A ON (A.AGEID = S.AGE_ID)
GROUP BY FISCAL_QUARTER, S.STORE_ID, STORE_ADDRESS, PAYMENT_DESC, AGE_GROUP;


SELECT SUM(S.REVENUE) AS REVENUE, SUM(S.PROFIT) AS PROFIT, PY.PAYMENT_DESC
FROM DBW.SALES_FACT S
JOIN DBW.PAYMENT_DIM PY
ON(S.PAYMENT_KEY = PY.PAYMENT_TYPE_KEY)
GROUP BY PAYMENT_DESC
ORDER BY 1 DESC;

SELECT SUM(S.REVENUE) AS REVENUE, SUM(S.PROFIT) AS PROFIT, PY.PAYMENT_CATEGORY
FROM DBW.SALES_FACT S
JOIN DBW.PAYMENT_DIM PY
ON(S.PAYMENT_KEY = PY.PAYMENT_TYPE_KEY)
GROUP BY PAYMENT_CATEGORY
ORDER BY 1 DESC;


SELECT SUM(S.REVENUE) AS REVENUE, SUM(S.PROFIT) AS PROFIT, PY.PAYMENT_DESC, D.FISCAL_QUARTER
FROM DBW.SALES_FACT S
JOIN DBW.PAYMENT_DIM PY
ON(S.PAYMENT_KEY = PY.PAYMENT_TYPE_KEY)
JOIN DBW.DATE_DIM D
ON(D.DATEID = S.DATE_ID)
GROUP BY PAYMENT_DESC, FISCAL_QUARTER
ORDER BY 3 DESC;

SELECT SUM(S.REVENUE) AS REVENUE, SUM(S.PROFIT) AS PROFIT, ST.STORE_NUMBER, ST.STORE_ADDRESS
FROM DBW.SALES_FACT S
JOIN DBW.STORE_DIM ST
ON(S.STORE_ID = ST.STORE_ID)
GROUP BY STORE_NUMBER, STORE_ADDRESS
ORDER BY 1 DESC;


SELECT SUM(S.REVENUE) AS REVENUE, SUM(S.PROFIT) AS PROFIT, ST.STORE_NUMBER, ST.STORE_ADDRESS, PY.PAYMENT_DESC
FROM DBW.SALES_FACT S
JOIN DBW.STORE_DIM ST
ON(S.STORE_ID = ST.STORE_ID)
JOIN DBW.PAYMENT_DIM PY
ON(S.PAYMENT_KEY = PY.PAYMENT_TYPE_KEY)
GROUP BY STORE_NUMBER, STORE_ADDRESS, PAYMENT_DESC
ORDER BY 1 DESC;


SELECT DISTINCT SUM(S.VOLUME) AS "SALES VOLUME", COUNT(C.FIRSTNAME) AS COUNT, C.FIRSTNAME
FROM DBW.SALES_FACT S
JOIN DBW.CUSTOMER_DIM C
ON(S.CUSTOMER_ID = C.CUSTOMER_ID)
GROUP BY FIRSTNAME;


SELECT DISTINCT SUM(S.VOLUME) AS "SALES VOLUME", COUNT(S.GENDER) AS COUNT, S.GENDER
FROM DBW.SALES_FACT S 
JOIN DBW.CUSTOMER_DIM C
ON(S.CUSTOMER_ID = C.CUSTOMER_ID)
GROUP BY S.GENDER;



SELECT MAX(DOLLAR_AMOUNT) HIGHESTSALES, D.FISCAL_QUARTER, 
	(SELECT EMPLOYEE_ID
	 FROM DBW.SALES_FACT
	 GROUP BY EMPLOYEE_ID
	 HAVING EMPLOYEE_ID IN (
		SELECT MAX(DOLLAR_AMOUNT)
		FROM DBW.SALES_FACT)) AS EMPLOYEE
FROM DBW.SALES_FACT
JOIN DBW.DATE_DIM D
ON(DATE_ID = D.DATEID)
GROUP BY FISCAL_QUARTER


SELECT MAX(S.DOLLAR_AMOUNT), S.EMPLOYEE_ID, E.EMPLOYEE_FNAME, D.FISCAL_QUARTER
FROM DBW.SALES_FACT S 
JOIN DBW.EMPLOYEES_DIM E ON(S.EMPLOYEE_ID = E.EMPLOYEE_ID)
JOIN DBW.DATE_DIM D ON(S.DATE_ID = D.DATEID)
GROUP BY S.EMPLOYEE_ID, EMPLOYEE_FNAME, FISCAL_QUARTER
ORDER BY 1 DESC;



SELECT COUNT(PAYMENT_TYPE) AS "AMOUNT PAID WITH CASH VS CREDIT", PAYMENT_TYPE
FROM DBW.PAYMENT_DIM
GROUP BY PAYMENT_TYPE;



SELECT COUNT(PROMOTION_DOLLAR_AMOUNT) AS "HOW MUCH USED MARKETING CAMPAIGN"
FROM DBW.SALES_FACT;

SELECT TOP 10 * 
FROM DBW.POPULATION_REF
ORDER BY YEAR_2016 DESC, YEAR_2017 DESC, YEAR_2018 DESC, YEAR_2019 DESC, YEAR_2020 DESC;

SELECT *
FROM DBW.MALE_BABY_NAMES_REF
ORDER BY FREQUENCY DESC;

SELECT *
FROM DBW.FEMALE_BABY_NAMES_REF
ORDER BY FREQUENCY DESC;